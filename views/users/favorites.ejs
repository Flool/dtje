<%- include('../_partials/header') %>

<div class="container content-card">
  
  
  <div class="row">
    <div class="col s3">
      <img src=<%=user.avatar %>>
      <%= user.name %></br>
      <%= user.location %>
      <form method="POST" action='/users/<%= user.id %>?_method=PUT'>
        <input type="text" name="location" value="<%= user.location %>"> <!-- Remove value?  --> 
        <button type="submit">Update Location</button>
      </form>
    </div>

    <div class="col s9">
      <h1>Your Favorites</h1>

      <% user.favorites.forEach(function(restaurant) { %>
        <!-- Materialize Card code below -->
        <div class="card">
          <div class="card-image waves-effect waves-block waves-light">
            <img src=<%= restaurant.image %> ><!-- add restaurant image here -->
            <span class="card-title grey-text text-darken-4">
              <!-- restaurant name here -->
              <%= restaurant.name %>
              <%= restaurant.categories.join(', ') %></br> 
            </span>
          </div>
        
          <div class="card-content">
            <p>
              <%= restaurant.price %></br> 
              Rated <%= restaurant.rating %>/5 by <%=restaurant.reviewCount %> Users </br>
              <form method="POST" action='/restaurants/<%= restaurant.id %>/unlike?_method=DELETE'>
                <button type="submit">Unlike</button>
              </form>
      
              <!-- <% if (restaurant.notes.length > 0) { %>
                <%= restaurant.notes[0].content %></br> 
              <% } %>  --> <!-- Looks Better Without This --> 
      
      
              <!-- Could we wrap these comments in a neat little container?--> 
              <form method="POST" action='/favorites/<%= restaurant.id %>'>
                <input type="text" name="content">
                <button type="submit">Add Note</button>
              </form>
              <div class="commentButtons"
              <% restaurant.notes.forEach(function(note) { %>
                <form method="POST" action='/favorites/<%= restaurant.id %>/notes/<%= note._id %>?_method=PUT'>
                  <input type="text" name="content" value="<%= note.content %>">
                  <button id="updateButton" type="submit">Update Note</button>
                </form>
                <form method="POST" action='/favorites/<%= restaurant.id %>/notes/<%= note._id %>?_method=DELETE'>
                  <button id="deleteButton" type="submit">Delete Note</button>
                </form>
              <% }); %>
              </div> 
            </p>
          </div>

          <div class="card-action">
            <a href="#">This is a link to nowhere</a>
          </div>
        
        </div>

          
          


      <% }); %> 
  

      

    </div>
  </div>
</div>

<%- include('../_partials/footer') %>